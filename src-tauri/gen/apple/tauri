#!/usr/bin/env node

// Wrapper script to invoke Tauri CLI from Xcode build process
import { spawn } from 'child_process';
import { fileURLToPath } from 'url';
import { dirname, resolve, join } from 'path';

// Get the directory of this script
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// Get the project root (3 levels up from gen/apple)
const projectRoot = resolve(__dirname, '../../..');

// Get the Tauri CLI path from node_modules
const tauriCliPath = join(projectRoot, 'node_modules', '.bin', 'tauri');

// Pass all arguments to the Tauri CLI
const args = process.argv.slice(2);

const child = spawn(tauriCliPath, args, {
  stdio: 'inherit',
  cwd: projectRoot,
  env: process.env
});

child.on('exit', (code) => {
  process.exit(code || 0);
});

child.on('error', (err) => {
  console.error('Failed to start Tauri CLI:', err);
  process.exit(1);
});

